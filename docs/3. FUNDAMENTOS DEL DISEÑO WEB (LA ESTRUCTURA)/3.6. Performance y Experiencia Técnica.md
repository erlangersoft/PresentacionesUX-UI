# 3.6. Performance y Experiencia Técnica

## Introducción

La performance no es solo técnica: **es UX**. Un sitio lento es un sitio con mala experiencia de usuario, sin importar cuán bello sea el diseño.

**Estadísticas clave:**
- 53% de usuarios abandonan si el sitio tarda >3 segundos en cargar
- 1 segundo de retraso = 7% menos conversiones
- Google penaliza sitios lentos en ranking SEO
- Core Web Vitals son factores de ranking desde 2021

Como diseñador UX/UI, debes entender performance para:
- Diseñar interfaces que carguen rápido
- Colaborar efectivamente con desarrolladores
- Optimizar assets visuales
- Diseñar estados de carga apropiados

---

## 3.6.1. Rendimiento Percibido vs. Real

### Performance Real

**Métricas técnicas (medibles):**

- **TTFB** (Time to First Byte): Tiempo hasta recibir primer byte del servidor
  - Objetivo: < 600ms

- **FCP** (First Contentful Paint): Tiempo hasta primer contenido visible
  - Objetivo: < 1.8s

- **LCP** (Largest Contentful Paint): Tiempo hasta elemento principal visible
  - Objetivo: < 2.5s (Core Web Vital)

- **TTI** (Time to Interactive): Tiempo hasta que la página es interactiva
  - Objetivo: < 3.8s

- **CLS** (Cumulative Layout Shift): Cuánto "salta" el contenido
  - Objetivo: < 0.1 (Core Web Vital)

- **FID** (First Input Delay): Tiempo hasta responder a interacción
  - Objetivo: < 100ms (Core Web Vital)

### Performance Percibida

**Lo que el usuario *siente*:**

Usuarios perciben performance de forma subjetiva. Diseño puede hacer que un sitio *se sienta* más rápido sin cambiar la velocidad real.

**Principios:**

1. **Respuesta inmediata**
   - Feedback instantáneo (< 100ms)
   - Loading indicators
   - Optimistic UI updates

2. **Carga progresiva**
   - Mostrar contenido incremental
   - No esperar a que todo cargue

3. **Skeleton screens**
   - Placeholder que imita estructura
   - Reduce ansiedad de espera

4. **Animaciones estratégicas**
   - Distraen durante esperas
   - Pero solo si son cortas (< 500ms)

**Ejemplo: Upload de archivo**

```html
<!-- Feedback inmediato -->
<div class="upload-feedback">
  <div class="upload-progress">
    <div class="progress-bar" style="width: 45%"></div>
  </div>
  <p class="upload-status">
    Subiendo... 45% (2.3 MB de 5 MB)
  </p>
  <button class="cancel-upload">Cancelar</button>
</div>
```

```css
.upload-progress {
  width: 100%;
  height: 8px;
  background: #e0e0e0;
  border-radius: 4px;
  overflow: hidden;
}

.progress-bar {
  height: 100%;
  background: linear-gradient(90deg, #4285f4, #34a853);
  transition: width 0.3s ease;
}

.upload-status {
  margin-top: 12px;
  font-size: 14px;
  color: #5f6368;
}
```

---

## 3.6.2. Carga Progresiva y Lazy Loading

### Progressive Enhancement

**Filosofía:** Construir en capas desde funcionalidad base.

**Capas:**

1. **Base:** HTML semántico (funciona en todos lados)
2. **Enhancement:** CSS (mejora presentación)
3. **Enhancement:** JS (añade interactividad)

**Ejemplo: Navegación**

```html
<!-- Layer 1: HTML funcional sin JS/CSS -->
<nav>
  <a href="#main">Saltar a contenido</a>
  <a href="/">Inicio</a>
  <a href="/cursos">Cursos</a>
  <a href="/contacto">Contacto</a>
</nav>

<!-- Layer 2: CSS mejora visuales -->
<style>
  nav { 
    display: flex; 
    gap: 24px; 
  }
</style>

<!-- Layer 3: JS añade interactividad -->
<script>
  // Mobile menu toggle solo si JS disponible
  const menuToggle = document.querySelector('.menu-toggle');
  menuToggle?.addEventListener('click', toggleMenu);
</script>
```

### Lazy Loading de Imágenes

**Loading nativo:**

```html
<!-- No carga hasta estar cerca del viewport -->
<img 
  src="course-thumbnail.jpg" 
  alt="Curso de UX"
  loading="lazy"
>
```

**Intersection Observer (más control):**

```html
<img 
  data-src="course-thumbnail.jpg" 
  alt="Curso de UX"
  class="lazy-image"
>
```

```javascript
const lazyImages = document.querySelectorAll('.lazy-image');

const imageObserver = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      const img = entry.target;
      img.src = img.dataset.src;
      img.classList.add('loaded');
      imageObserver.unobserve(img);
    }
  });
}, {
  rootMargin: '50px'  // Cargar 50px antes de viewport
});

lazyImages.forEach(img => imageObserver.observe(img));
```

```css
.lazy-image {
  opacity: 0;
  transition: opacity 0.3s;
}

.lazy-image.loaded {
  opacity: 1;
}
```

### Lazy Loading de Componentes (Code Splitting)

```javascript
// Cargar modal solo cuando se necesita
const openModal = async () => {
  const { Modal } = await import('./Modal.js');
  const modal = new Modal();
  modal.open();
};
```

---

## 3.6.3. Optimización de Assets Visuales

### Imágenes

**Formatos modernos:**

| Formato | Uso | Ventajas | Soporte |
|---------|-----|----------|---------|
| **WebP** | Fotos | 25-35% más pequeño que JPEG | Moderno (95%+) |
| **AVIF** | Fotos | 50% más pequeño que JPEG | Limitado (75%) |
| **SVG** | Iconos, logos | Escalable, pequeño | Universal |
| **PNG** | Transparencia | Lossless | Universal |
| **JPEG** | Fotos (legacy) | Amplio soporte | Universal |

**Implementación con fallbacks:**

```html
<picture>
  <source type="image/avif" srcset="hero.avif">
  <source type="image/webp" srcset="hero.webp">
  <img src="hero.jpg" alt="Hero image">
</picture>
```

**Tamaños apropiados:**

```html
<!-- Servir tamaño correcto según viewport -->
<img
  src="course-400.jpg"
  srcset="
    course-400.jpg 400w,
    course-800.jpg 800w,
    course-1200.jpg 1200w
  "
  sizes="
    (max-width: 640px) 100vw,
    (max-width: 1024px) 50vw,
    400px
  "
  alt="Curso"
>
```

**Compresión:**
- Fotos: 60-80% calidad JPEG (sweet spot)
- Herramientas: Squoosh, ImageOptim, TinyPNG

### Iconos

**SVG inline (mejor performance):**

```html
<button class="icon-button">
  <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
    <path d="M12 4v16m8-8H4" stroke="currentColor" stroke-width="2"/>
  </svg>
  Agregar curso
</button>
```

```css
.icon-button svg {
  width: 20px;
  height: 20px;
  stroke: currentColor;  /* Hereda color del texto */
}
```

**Icon fonts (muchos iconos):**

```html
<link href="icon-font.css" rel="stylesheet">

<i class="icon-star"></i>
<i class="icon-heart"></i>
```

**SVG sprite (compromiso):**

```html
<!-- Sprite externo, cacheable -->
<svg class="icon">
  <use href="icons.svg#star"></use>
</svg>
```

### Fonts

**Font-display para evitar FOIT/FOUT:**

```css
@font-face {
  font-family: 'Inter';
  src: url('inter.woff2') format('woff2');
  font-display: swap;  /* Usa fallback, swap cuando carga */
}
```

**Opciones de font-display:**

- `auto`: Navegador decide (generalmente block)
- `block`: Texto invisible hasta 3s (FOIT - Flash of Invisible Text)
- `swap`: Muestra fallback inmediato, swap cuando carga (FOUT - Flash of Unstyled Text)
- `fallback`: Block corto (100ms), luego swap 3s, luego queda fallback
- `optional`: Block 100ms, luego navegador decide si vale la pena mostrar

**Recomendación:** `swap` para mejor perceived performance.

**Preload fonts críticos:**

```html
<link 
  rel="preload" 
  href="inter.woff2" 
  as="font" 
  type="font/woff2"
  crossorigin
>
```

**Variable fonts (menos requests):**

```css
@font-face {
  font-family: 'Inter Variable';
  src: url('inter-variable.woff2') format('woff2');
  font-weight: 100 900;  /* Todo el rango en un archivo */
}
```

### CSS y JavaScript

**Minificación:**
- Remover espacios, comentarios
- Acortar nombres de variables (JS)
- Herramientas: Terser, cssnano

**Compression:**
- Gzip (clásico): ~70% reducción
- Brotli (moderno): ~80% reducción

**Critical CSS:**

```html
<head>
  <!-- Inline CSS crítico para above-the-fold -->
  <style>
    .header { ... }
    .hero { ... }
  </style>
  
  <!-- Resto de CSS async -->
  <link rel="preload" href="styles.css" as="style">
  <link rel="stylesheet" href="styles.css" media="print" onload="this.media='all'">
</head>
```

---

## 3.6.4. Skeleton Screens y Progressive Disclosure

### Skeleton Screens

**¿Qué son?**
Placeholders que imitan la estructura del contenido real, mostrando "huesos" del layout mientras carga.

**Por qué funcionan:**
- Reducen ansiedad (usuarios ven que algo pasa)
- Percepción de carga más rápida
- Evitan layout shifts (CLS)

**Ejemplo: Card de curso**

```html
<div class="course-card skeleton">
  <div class="skeleton-image"></div>
  <div class="skeleton-content">
    <div class="skeleton-title"></div>
    <div class="skeleton-text"></div>
    <div class="skeleton-text short"></div>
  </div>
</div>
```

```css
.skeleton {
  pointer-events: none;
}

.skeleton-image,
.skeleton-title,
.skeleton-text {
  background: linear-gradient(
    90deg,
    #f0f0f0 25%,
    #e0e0e0 50%,
    #f0f0f0 75%
  );
  background-size: 200% 100%;
  animation: shimmer 1.5s infinite;
  border-radius: 8px;
}

@keyframes shimmer {
  0% {
    background-position: 200% 0;
  }
  100% {
    background-position: -200% 0;
  }
}

.skeleton-image {
  width: 100%;
  height: 180px;
}

.skeleton-title {
  height: 24px;
  width: 70%;
  margin-bottom: 12px;
}

.skeleton-text {
  height: 16px;
  width: 100%;
  margin-bottom: 8px;
}

.skeleton-text.short {
  width: 60%;
}
```

**Transición a contenido real:**

```javascript
// Cargar datos
const courses = await fetchCourses();

// Reemplazar skeletons
const container = document.querySelector('.course-grid');
container.innerHTML = courses.map(course => `
  <div class="course-card fade-in">
    <img src="${course.image}" alt="${course.title}">
    <h3>${course.title}</h3>
    <p>${course.description}</p>
  </div>
`).join('');
```

```css
.fade-in {
  animation: fadeIn 0.3s ease-out;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
```

### Progressive Disclosure

**Principio:** Mostrar solo lo necesario, revelar más bajo demanda.

**Beneficios:**
- Reduce cognitive load
- Mejora performance (menos contenido inicial)
- Mejor mobile UX (espacio limitado)

**Patrones:**

**1. Acordeones (FAQ):**

```html
<div class="accordion">
  <button 
    class="accordion-trigger"
    aria-expanded="false"
    aria-controls="answer-1"
  >
    ¿Cuánto dura el curso?
    <span class="icon">▼</span>
  </button>
  
  <div 
    id="answer-1" 
    class="accordion-content"
    hidden
  >
    <p>El curso tiene una duración de 8 semanas con dedicación estimada de 4-6 horas semanales.</p>
  </div>
</div>
```

```css
.accordion-content {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.3s ease;
}

.accordion-trigger[aria-expanded="true"] + .accordion-content {
  max-height: 500px;
}
```

**2. "Ver más" (lista larga):**

```html
<ul class="comment-list">
  <li>Comentario 1</li>
  <li>Comentario 2</li>
  <li>Comentario 3</li>
  <!-- Inicialmente ocultos -->
  <li class="hidden">Comentario 4</li>
  <li class="hidden">Comentario 5</li>
</ul>

<button class="load-more">Ver más comentarios (23)</button>
```

**3. Infinite scroll:**

```javascript
const observer = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      loadMoreCourses();
    }
  });
});

const sentinel = document.querySelector('.load-more-sentinel');
observer.observe(sentinel);
```

---

## 3.6.5. Colaboración UI/Front-end

### Handoff: De Diseño a Desarrollo

**Objetivo:** Transferir diseños de forma que developers puedan implementar con precisión y eficiencia.

**Herramientas de handoff:**

1. **Figma Inspect (Dev Mode)**
   - Developers inspeccionan directamente
   - CSS code snippets
   - Assets exportables

2. **Zeplin**
   - Specs automáticas
   - Style guide generado
   - Comentarios y versiones

3. **Abstract**
   - Versionado de diseños
   - Branches como Git

### Información Esencial en Handoff

**1. Especificaciones visuales:**
- Dimensiones (px, rem)
- Espaciado (padding, margin)
- Colores (hex, rgba)
- Tipografía (family, size, weight, line-height)
- Sombras (box-shadow)
- Bordes (border-radius, border)

**2. Estados:**
- Default
- Hover
- Active
- Focus
- Disabled
- Loading
- Error

**3. Comportamiento:**
- Animaciones (duración, easing, trigger)
- Interacciones (click, hover, scroll)
- Validaciones (formularios)
- Responsive breakpoints

**4. Assets:**
- Imágenes exportadas en tamaños correctos
- Iconos (SVG preferentemente)
- Formatos apropiados (WebP, PNG, SVG)

### Design Tokens

**¿Qué son?**
Variables de diseño nombradas consistentemente, compartidas entre diseño y código.

**Beneficios:**
- Single source of truth
- Consistencia garantizada
- Fácil actualización global
- Temas (light/dark) automáticos

**Ejemplo de tokens:**

```css
/* Design Tokens */
:root {
  /* Colors */
  --color-primary-50: #e3f2fd;
  --color-primary-500: #2196f3;
  --color-primary-700: #1976d2;
  
  --color-neutral-50: #fafafa;
  --color-neutral-500: #9e9e9e;
  --color-neutral-900: #212121;
  
  --color-success: #4caf50;
  --color-error: #f44336;
  --color-warning: #ff9800;
  
  /* Typography */
  --font-family-sans: 'Inter', -apple-system, sans-serif;
  --font-family-mono: 'JetBrains Mono', monospace;
  
  --font-size-xs: 0.75rem;    /* 12px */
  --font-size-sm: 0.875rem;   /* 14px */
  --font-size-base: 1rem;     /* 16px */
  --font-size-lg: 1.125rem;   /* 18px */
  --font-size-xl: 1.25rem;    /* 20px */
  --font-size-2xl: 1.5rem;    /* 24px */
  --font-size-3xl: 1.875rem;  /* 30px */
  
  --font-weight-normal: 400;
  --font-weight-medium: 500;
  --font-weight-semibold: 600;
  --font-weight-bold: 700;
  
  --line-height-tight: 1.25;
  --line-height-normal: 1.5;
  --line-height-relaxed: 1.75;
  
  /* Spacing (8pt grid) */
  --space-1: 0.5rem;   /* 8px */
  --space-2: 1rem;     /* 16px */
  --space-3: 1.5rem;   /* 24px */
  --space-4: 2rem;     /* 32px */
  --space-6: 3rem;     /* 48px */
  --space-8: 4rem;     /* 64px */
  
  /* Border Radius */
  --radius-sm: 4px;
  --radius-md: 8px;
  --radius-lg: 12px;
  --radius-full: 9999px;
  
  /* Shadows */
  --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
  --shadow-md: 0 4px 6px rgba(0,0,0,0.1);
  --shadow-lg: 0 10px 15px rgba(0,0,0,0.1);
  
  /* Transitions */
  --transition-fast: 150ms ease;
  --transition-base: 300ms ease;
  --transition-slow: 500ms ease;
}
```

**Uso de tokens:**

```css
.button {
  background: var(--color-primary-500);
  color: white;
  font-family: var(--font-family-sans);
  font-size: var(--font-size-base);
  font-weight: var(--font-weight-semibold);
  padding: var(--space-2) var(--space-4);
  border-radius: var(--radius-md);
  box-shadow: var(--shadow-sm);
  transition: all var(--transition-fast);
}

.button:hover {
  background: var(--color-primary-700);
  box-shadow: var(--shadow-md);
}
```

**Dark mode con tokens:**

```css
@media (prefers-color-scheme: dark) {
  :root {
    --color-neutral-50: #212121;
    --color-neutral-900: #fafafa;
    /* Tokens se redefinien, componentes se adaptan automáticamente */
  }
}
```

### Documentación para Developers

**Componentes bien documentados:**

```markdown
## Button Component

### Props
- `variant`: 'primary' | 'secondary' | 'ghost'
- `size`: 'sm' | 'md' | 'lg'
- `disabled`: boolean
- `loading`: boolean
- `icon`: SVG element (optional)

### Estados
- Default: bg-primary-500, hover -> bg-primary-700
- Disabled: opacity-50, cursor-not-allowed
- Loading: Mostrar spinner, pointer-events-none

### Accesibilidad
- Usar <button> semántico
- aria-disabled="true" cuando disabled
- aria-label cuando solo icon

### Ejemplo de uso
```html
<button class="btn btn-primary btn-lg">
  Inscribirme al curso
</button>
```
```

### Reuniones de Sincronización

**Design Review:**
- Antes de desarrollo: validar factibilidad técnica
- Durante: resolver dudas, ajustar si necesario
- QA: validar implementación vs diseño

**Temas a discutir:**
- Performance implications de diseño
- Animaciones complejas (¿valen la pena?)
- Edge cases (contenido muy largo, sin datos, errores)
- Responsive breakpoints
- Accesibilidad

---

## Aplicación en EduConnect

### Optimización de Homepage

**Prioridades de carga:**

1. **Critical (above-the-fold):**
   - Header con navegación
   - Hero section
   - CSS inline crítico

2. **Important (visible con scroll):**
   - Grid de cursos (lazy load)
   - Buscar cursos

3. **Deferred (bajo demanda):**
   - Footer
   - Modals (login, signup)
   - Chat de soporte

**Implementación:**

```html
<!DOCTYPE html>
<html>
<head>
  <!-- Critical CSS inline -->
  <style>
    .header { ... }
    .hero { ... }
  </style>
  
  <!-- Preload hero image -->
  <link rel="preload" as="image" href="hero.webp">
  
  <!-- Preconnect to API -->
  <link rel="preconnect" href="https://api.educonnect.com">
</head>
<body>
  <!-- Above-the-fold: carga inmediata -->
  <header class="header">...</header>
  <section class="hero">...</section>
  
  <!-- Skeleton mientras carga cursos -->
  <div class="course-grid">
    <div class="course-card skeleton">...</div>
    <div class="course-card skeleton">...</div>
    <div class="course-card skeleton">...</div>
  </div>
  
  <!-- Lazy load images -->
  <img src="course.jpg" loading="lazy" alt="Curso">
  
  <!-- Defer non-critical JS -->
  <script src="app.js" defer></script>
</body>
</html>
```

### Design Tokens de EduConnect

```css
:root {
  /* Brand Colors */
  --edu-primary: #2563eb;      /* Blue */
  --edu-primary-dark: #1e40af;
  --edu-secondary: #f59e0b;    /* Amber */
  --edu-accent: #8b5cf6;       /* Purple */
  
  /* Semantic Colors */
  --edu-success: #10b981;
  --edu-error: #ef4444;
  --edu-warning: #f59e0b;
  --edu-info: #3b82f6;
  
  /* Typography */
  --edu-font-display: 'Poppins', sans-serif;
  --edu-font-body: 'Inter', sans-serif;
  
  /* Component Specific */
  --edu-card-radius: 12px;
  --edu-card-shadow: 0 4px 12px rgba(0,0,0,0.08);
  --edu-button-radius: 8px;
  --edu-input-radius: 6px;
}
```

---

## Conclusiones Clave

- **Performance = UX:** Un sitio lento es mala UX, sin importar diseño
- **Perceived performance:** Diseño puede hacer sitio *sentir* más rápido
- **Progressive loading:** Mostrar contenido incremental, no esperar a todo
- **Skeleton screens:** Reducen ansiedad y CLS
- **Optimizar assets:** WebP, lazy loading, right-sizing
- **Design tokens:** Single source of truth entre diseño y código
- **Handoff claro:** Specs, estados, comportamientos bien documentados
- **Colaboración:** Diseñadores y developers deben hablar temprano y seguido

---

## Referencias y Recursos

### Lecturas Recomendadas

1. **"Designing for Performance" (2014)** - Lara Hogan
   - Performance desde perspectiva de diseño
   - Optimización de assets

2. **"High Performance Browser Networking" (2013)** - Ilya Grigorik
   - Fundamentos técnicos
   - Cómo funcionan navegadores

### Recursos en Línea

1. **web.dev** (web.dev)
   - Guías de Core Web Vitals
   - Tutoriales de optimización

2. **PageSpeed Insights** (pagespeed.web.dev)
   - Analizar performance de sitio
   - Recomendaciones específicas

3. **WebPageTest** (webpagetest.org)
   - Testing detallado
   - Waterfall charts, filmstrip view

4. **Can I Use** (caniuse.com)
   - Soporte de navegadores
   - Para features modernas (lazy loading, WebP, etc.)

### Herramientas

1. **Lighthouse** (Chrome DevTools)
   - Auditoría de performance, accesibilidad, SEO
   - Integrado en Chrome

2. **Squoosh** (squoosh.app)
   - Optimizar imágenes
   - Comparar formatos (WebP, AVIF)

3. **Figma Dev Mode**
   - Inspeccionar diseños
   - Exportar CSS, assets

4. **Design Tokens**
   - Style Dictionary (Amazon)
   - Theo (Salesforce)
   - Tokens Studio (Figma plugin)


## 